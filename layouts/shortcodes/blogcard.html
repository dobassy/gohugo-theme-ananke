{{/* If you want to use this shortcode, you need to set the API server endpoint in config.toml */}}
{{/* e.g. `ogpApiServer = "http://localhost:6060/getogp?"` */}}

{{ $url := ( .Get 0) }}
{{ if and (.Site.Params.ogpApiServer) (ne (getenv "OGP_DISABLED") "true" ) (eq (getenv "HUGO_ENV") "production" | or (eq .Site.Params.env "production")) }}
  {{ $function := print .Site.Params.ogpApiServer (querify "url" $url )}}
  {{ $ogpjson := getJSON $function }} {{ $urlp := urls.Parse $url }}

  <div class="blogcard">
    <a href="{{ $ogpjson.url }}">
      <div class="blogcard-thumbnail">
        <img
          class="blogcard-img"
          src="{{ $ogpjson.image }}"
          alt="{{ $ogpjson.title }}"
          width="150"
          height="150"
        />
      </div>
      <div class="blogcard-content">
        <div class="blogcard-title">
          <strong> {{ $ogpjson.title | truncate 50}} </strong>
        </div>
        <div class="blogcard-extract">
          {{ $ogpjson.description | truncate 70}}
        </div>
      </div>
      <div class="blogcard-host">{{ $urlp.Host }}</div>
      <div class="clear"></div>
    </a>
  </div>
{{ else }}
  <p class="blogcard-alternative">Related Link: <a href="{{ $url }}">{{ $url }}</a></p>
{{ end }}